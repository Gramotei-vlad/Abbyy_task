# Abbyy_task
Описание
--
Эксперименты на датасете [conll2003](https://huggingface.co/datasets/conll2003) для
задания на ABBYY курсе.

Установка
--
Склонируйте репозиторий в colab или себе на комп и установите
нужные библиотеки 
```
   pip install -r requirements.txt
```

Обучение
--
Чтобы начать обучать модель, то введите команду ниже
```
   python main.py
```
Команда выше запустит LSTM модель с кросс-энтропией. 
Параметры обучения можно глянуть в main.py.

Графики обучения
--
Графики обучения можно глянуть [здесь](https://wandb.ai/v-kosukhin/Abbyy_task?workspace=user-v-kosukhin)


Результаты на тестовом наборе данных.
--

Кросс-энтропия + веса классов;

               precision   recall   f1-score  support


           '       0.86      1.00      0.92        12
    AD_TOKEN       1.00      1.00      1.00      3282
           B       0.81      0.89      0.85      1480
          BD       0.95      0.91      0.93      1765
          BG       0.82      0.91      0.86       436
          BN       0.75      0.88      0.81       695
          BP       0.83      0.90      0.87       304
          BR       0.53      0.48      0.51        48
          BS       0.78      0.88      0.82         8
          BZ       0.82      0.91      0.86       450
           C       0.99      1.00      1.00       761
           D       0.96      0.94      0.95      3508
          DT       0.92      0.92      0.92       115
           H       0.43      1.00      0.60         3
           J       0.78      0.77      0.78      2266
          JR       0.66      0.76      0.71        80
          JS       0.80      0.94      0.87        48
           N       0.88      0.89      0.89      6631
          NP       0.89      0.85      0.87      5939
         NPS       0.28      0.60      0.38        73
          NS       0.92      0.92      0.92      2158
           O       1.00      1.00      1.00       819
          OS       1.00      0.96      0.98       360
           P       0.78      0.93      0.85       185
          P$       1.00      1.00      1.00         9
          RB       1.00      1.00      1.00        74
          RP       0.97      0.99      0.98       592
         RP$       1.00      0.99      0.99       298
           S       0.00      0.00      0.00         0
           T       0.99      0.99      0.99      2766
           W       0.34      0.73      0.47        15
           X       0.97      0.94      0.96        35
          YM       0.98      0.96      0.97       120
           _       1.00      1.00      1.00      3768
    micro avg      0.91      0.92      0.92     39103
    macro avg      0.81      0.88      0.84     39103
    weighted avg   0.92      0.92      0.92     39103


Focal loss;

                 precision  recall  f1-score  support

           '       0.86      1.00      0.92        12
    AD_TOKEN       1.00      1.00      1.00      3280
           B       0.81      0.87      0.84      1508
          BD       0.96      0.91      0.93      1781
          BG       0.83      0.89      0.86       446
          BN       0.74      0.89      0.81       678
          BP       0.82      0.92      0.87       293
          BR       0.65      0.51      0.57        55
          BS       0.89      0.89      0.89         9
          BZ       0.83      0.91      0.87       456
           C       0.99      1.00      1.00       760
           D       0.95      0.94      0.95      3516
          DT       0.92      0.94      0.93       113
           H       0.43      1.00      0.60         3
           J       0.78      0.76      0.77      2266
          JR       0.62      0.77      0.69        74
          JS       0.79      0.96      0.86        46
           N       0.88      0.89      0.88      6620
          NP       0.88      0.85      0.87      5955
         NPS       0.24      0.49      0.33        80
          NS       0.92      0.92      0.92      2145
           O       1.00      1.00      1.00       817
          OS       1.00      0.96      0.98       360
           P       0.78      0.92      0.84       186
          P$       1.00      1.00      1.00         9
          RB       0.99      1.00      0.99        73
          RP       0.98      0.99      0.98       597
         RP$       1.00      0.99      0.99       298
           S       0.00      0.00      0.00         0
           T       0.98      0.99      0.99      2765
           W       0.38      0.92      0.53        13
           X       0.97      1.00      0.99        33
          YM       0.98      0.96      0.97       120
           _       1.00      1.00      1.00      3770

    micro avg      0.91      0.92      0.91     39137
    macro avg      0.82      0.88      0.84     39137
    weighted avg   0.91      0.92      0.91     39137


Cross entropy;

                precision   recall   f1-score  support

           '       0.86      1.00      0.92        12
    AD_TOKEN       0.99      0.99      0.99      3273
           B       0.82      0.88      0.85      1522
          BD       0.93      0.94      0.93      1677
          BG       0.82      0.90      0.86       434
          BN       0.84      0.82      0.83       830
          BP       0.82      0.91      0.86       301
          BR       0.42      0.69      0.52        26
          BS       0.67      0.86      0.75         7
          BZ       0.81      0.93      0.87       437
           C       0.99      1.00      1.00       761
           D       0.95      0.94      0.94      3491
          DT       0.92      0.93      0.93       114
           H       0.43      1.00      0.60         3
           J       0.77      0.79      0.78      2152
          JR       0.83      0.76      0.79       100
          JS       0.82      0.90      0.86        51
           N       0.88      0.89      0.89      6600
          NP       0.89      0.85      0.87      5951
         NPS       0.39      0.58      0.47       108
          NS       0.92      0.92      0.92      2161
           O       1.00      1.00      1.00       819
          OS       0.99      0.96      0.97       356
           P       0.83      0.91      0.87       201
          P$       1.00      1.00      1.00         9
          RB       0.99      1.00      0.99        73
          RP       0.99      0.99      0.99       604
         RP$       1.00      1.00      1.00       296
           S       0.04      1.00      0.08         1
           T       0.99      0.99      0.99      2782
           W       0.34      0.73      0.47        15
           X       0.97      1.00      0.99        33
          YM       0.98      0.93      0.95       124
           _       1.00      1.00      1.00      3766

    micro avg       0.91      0.92      0.92     39090
    macro avg       0.82      0.91      0.84     39090
    weighted avg    0.92      0.92      0.92     39090


Получение результатов на тесте.
--

Обученные модели лежат [здесь](https://drive.google.com/drive/folders/18_H1CfXR3K2kh3NAzQ07ndfELDERbCLG?usp=sharing)
Чтобы прогнать модель на тесте, введите команду 
```
   python main.py --inference --inference_model_path=<Директория с tf моделью>
```